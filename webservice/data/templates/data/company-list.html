{% extends "data/template.html" %}

{% block title %}Companies{% endblock %}

{% block bread_1 %}{% endblock %}
{% block bread_active %}{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-2">
        <h1>Alerts</h1>
    </div>
    <div class="col-md-5">
        <a class="btn btn-primary btn-refresh" href="{% url 'data:alerts' %}">Refresh</a>
        <a class="btn btn-primary btn-refresh" href="{% url 'measurementtype-list' %}">Set boundaries</a>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        {% for c in results %}
            {% if c.not_archived %}
                <h2>{{ c.name }}<span class="badge">{{ c.not_archived|length }}</span></h2>
            {% endif %}
            {% for alert in c.not_archived %}
                    <div class="alert alert-danger" role="alert">
                        <a href="{% url 'alert-alert' alert.gateway alert.sensor alert.id %}">{{ alert.text }}</a>
                    </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <h1>Companies</h1>

        <a href="{% url 'company-new' %}" class="btn btn-xs">
            <span class="glyphicon glyphicon-plus"></span> Add Company
        </a>

        <div id="company-list">
            <input type="text" class="fuzzy-search" placeholder="Search company name" />
            <ul class="list">
                {% for c in results %}
                <li>
                    <a class="name" href="{% url 'company-detail' c.company_id %}">{{ c.name }}</a>
                </li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
    <script>
        var companyList = new List('company-list', {
            valueNames: ['name'],
            plugins: [ ListFuzzySearch() ]
        });
    </script>
{% endblock %}